### 基本认证
  
http提供一个原生的质询/响应， web应用程序收到一条http请求报文时，服务器并没有按照请求执行动作，而是以一个认证质询进行响应，要求用户提供一些保密信息来说明他是谁。

#### 认证的步骤

|步骤|首部|描述|方法/状态|
|----|----|----|----|
|请求||第一条无认证信息的请求|GET|
|质询|WWW-Authenticate|服务器用401拒绝了请求，说明需要提供用户名和密码，服务器上可能分不同的区域，每个区域都有自己的密码，WWW-Authenticate首部对保护的区域进行描述，认证的算法也是这里指定的，通常客户端弹框让用户输入用户名和密码|401 Unauthorized|
|授权|Authorization|type credentials客户端重新发送请求，附带上该首部，用来说明算法和用户名和密码|GET|
|成功|Authorization-Info|如果授权正确，服务器就会返回资源，有些授权算法会在此首部返回一些与授权有关的信息|200 OK|

#### 缺陷
  
1、基本认证会通过网络发送用户名和密码，这些用户名和密码都是以一种很容易解码的形式表示，base64加密其实属于明文，如果有动机的去拦截就非常容易获取到，这就是所谓防君子不防小人

2、即使密码是更加难解密的方法加密，第三方用户人仍然可以捕获被修改过的用户名和密码，并将该密码发送给服务器获取访问权  

3、基本认证没有提供任何针对代理和中介人使用的防护措施  
  
4、很容易被伪造的服务器骗过认证信息

### 摘要认证

Digest摘要认证是另一种HTTP认证协议，具体进行下如下改进：  
1、永远不会明文方式在网络上发送密码  
2、可以防止恶意用户捕获并重发认证的握手过程  
3、可以有选择地防止对报文内容的篡改  
4、防范几种常见的攻击方式  

#### 用摘要保护密码

客户端不会发送密码，而是发送一个摘要，这个是密码的不可逆扰码，常见的摘要函数MD5
digest('密码') => 摘要  
摘要和密码一样好用，只要截获摘要就可以一次次的重发给服务器，用随机数防止重攻击，服务器每次都会发送随机数，计算摘要时加入随机数nonce令牌(经常变换或者每次认证都变化)。

与公有秘钥加密机制对比，除了能保护密码，没有提供保护其他内容的方式，其余部分仍然可能被窃听


### 安全形式的http：https
HTTP安全版本需要满足以下的特定：  
|特点|描述|
|----|----|
|客户端认证|服务端知道它们是不是与真的客户器而不是伪造的客户器通话|
|服务器端认证|客户端知道它们是不是与真的服务器而不是伪造的服务器通话|
|完整性|客户端和服务器数据不会被修改|
|加密|对话是私密的，无法被窃听|
|效率|一个运行足够快的算法、以便低端的客户端和服务器使用|
|普适性|基本所有客户端和服务器都支持这种协议|
|管理可扩展性|何时何地都能进行通信|
|适应性|能够支持当前最知名的安全方法|
|在社会上可行性|满足社会的政治文化|  
  
HTTPS是目前最流行的HTTP安全方式，所有主流的浏览器和服务器都支持。使用HTTPS时，所有的请求和响应在发送到网络时都要进行加密，通常为SSL。默认端口443，通常使用开源的OpenSSL库

报文+证书(公钥)加密->（传输）->服务器+（私钥）解密


### token  

我们都是知道HTTP协议是无状态的，这种无状态意味着程序需要验证每一次请求，从而辨别客户端的身份。
在这之前，程序都是通过在服务端存储的登录信息来辨别请求的。这种方式一般都是通过存储Session来完成。
基于Token的身份验证是无状态的，我们不将用户信息存在服务器中。这种概念解决了在服务端存储信息时的许多问题。
  
基于Token的身份验证的过程如下:
1、用户通过用户名和密码发送请求。
2、服务器端程序验证。  
3、服务器端程序返回一个带签名的token 给客户端。  
4、客户端储存token,并且每次访问API都携带Token到服务器端的。  
5、服务端验证token，校验成功则返回请求数据，校验失败则返回错误码。  

### SSO
当用户第一次访问应用系统的时候，因为还没有登录，会被引导到认证系统中进行登录；根据用户提供的登录信息，认证系统进行身份校验，如果通过校验，应该返回给用户一个认证的凭据－－ticket；用户再访问别的应用的时候，就会将这个ticket带上，作为自己认证的凭据，应用系统接受到请求之后会把ticket送到认证系统进行校验，检查ticket的合法性。如果通过校验，用户就可以在不用再次登录的情况下访问应用系统2和应用系统3了。  
  
用户登录成功拿到token(或者是session-id)后怎么让浏览器存储和分享到其它域名下？同域名很简单，把token存在cookie里，把cookie的路径设置成顶级域名下，这样所有子域都能读取cookie中的token。这就是共享cookie的方式。  
跨域的情况下：写入的cookie开放所有域
  
优点：  
1、提高用户的效率，不需要多次登录
2、提高开发人员的效率，通用的登录认证框架不需要对登录额外关心
3、简化管理，如果应用程序加入了单点登录协议，管理用户帐号的负担就会减轻
缺点：  
1、不利于重构，涉及到很多的系统，要重构必须要兼容所有的系统
2、无人看守桌面，因为只需要登录一次，所有的授权的应用系统都可以访问，可能导致一些很重要的信息泄露